$(function(){new (Backbone.View.extend({initialize:function(){_.bindAll(this,"mouseDownEventListener","mouseUpEventListener","updateMouseCoordinates","updateWorldEventListener");this.pixelMeterRatio=30;this.boundaryThickness=10;this.b2World=new Box2D.Dynamics.b2World(new Box2D.Common.Math.b2Vec2(0,9.8),!0);this.b2Elements=[];this.createBoundaries();this.addExperiencesToWorld();this.addEducationsToWorld();this.mouseY=this.mouseX=0;this.isMouseDown=!1;this.b2Joint=null;$("#b2dDiv").mousedown(this.mouseDownEventListener); $(document).mouseup(this.mouseUpEventListener);setInterval(this.updateWorldEventListener,1E3/60)},updateWorldEventListener:function(){this.controlMouse();this.b2World.Step(1/60,10,10);this.b2World.ClearForces();for(var a=0;a<this.b2Elements.length;a++){var c=this.b2Elements[a].GetUserData();this.b2Elements[a].GetPosition();this.b2Elements[a].GetPosition();c.css("left",this.b2Elements[a].GetPosition().x*this.pixelMeterRatio);c.css("top",this.b2Elements[a].GetPosition().y*this.pixelMeterRatio);var b= Math.round(this.b2Elements[a].GetAngle()*180/Math.PI*100)/100;c.css("-webkit-transform","rotate("+b+"deg)");c.css("-moz-transform","rotate("+b+"deg)");c.css("msTransform","rotate("+b+"deg)")}},mouseDownEventListener:function(a){this.isMouseDown=!0;this.updateMouseCoordinates(a);document.addEventListener("mousemove",this.updateMouseCoordinates,!0)},mouseUpEventListener:function(){document.removeEventListener("mousemove",this.updateMouseCoordinates,!0);this.isMouseDown=!1},updateMouseCoordinates:function(a){this.mouseX= (a.pageX-$("#b2dDiv").offset().left)/this.pixelMeterRatio;this.mouseY=(a.pageY-$("#b2dDiv").offset().top)/this.pixelMeterRatio},addInstructionsToWorld:function(){var a=$("<div></div>").attr({width:200,height:200});a.css("position","absolute");a.css("border","1px coral solid");a.css("-webkit-transform-origin","0% 0%");a.css("-moz-transform-origin","0% 0%");a.css("msTransformOrigin","0% 0%");$("#b2dDiv").append(a);var c=$("<canvas></canvas>").attr({width:200,height:200}),b=c[0].getContext("2d");b.fillStyle= "rgb(200,0,0)";b.beginPath();b.arc(100,100,100,0,Math.PI*2,!0);b.closePath();b.fill();a.append(c);c=new Box2D.Dynamics.b2BodyDef;c.position.Set(10/this.pixelMeterRatio,10/this.pixelMeterRatio);c.type=Box2D.Dynamics.b2Body.b2_dynamicBody;c.userData=a;a=this.b2World.CreateBody(c);c=new Box2D.Collision.Shapes.b2CircleShape;c.SetRadius(100/this.pixelMeterRatio);c.SetLocalPosition(new Box2D.Common.Math.b2Vec2(100/this.pixelMeterRatio,100/this.pixelMeterRatio));b=new Box2D.Dynamics.b2FixtureDef;b.shape= c;b.density=0.7;b.friction=0.5;b.restitution=0.5;a.CreateFixture(b);this.b2Elements.push(a)},addExperiencesToWorld:function(){var a=this.addElementToWorld(150,150,100,"#D9CEB2","Experience","(recent)","#7A6A53"),c=this.addElementToWorld(200,50,50,"#D9CEB2","Cisco","2011-present","#7A6A53"),b=this.addElementToWorld(350,200,50,"#D9CEB2","viaSat","2010-2010","#7A6A53"),d=this.addElementToWorld(200,350,50,"#D9CEB2","Adobe","2009-2009","#7A6A53"),h=this.addElementToWorld(50,200,50,"#D9CEB2","CSBU","2008-2008", "#7A6A53"),f=new Box2D.Dynamics.Joints.b2DistanceJointDef;f.Initialize(a,c,new Box2D.Common.Math.b2Vec2(250/this.pixelMeterRatio,250/this.pixelMeterRatio),new Box2D.Common.Math.b2Vec2(250/this.pixelMeterRatio,100/this.pixelMeterRatio));this.b2World.CreateJoint(f);f=new Box2D.Dynamics.Joints.b2DistanceJointDef;f.Initialize(a,b,new Box2D.Common.Math.b2Vec2(250/this.pixelMeterRatio,250/this.pixelMeterRatio),new Box2D.Common.Math.b2Vec2(400/this.pixelMeterRatio,250/this.pixelMeterRatio));this.b2World.CreateJoint(f); f=new Box2D.Dynamics.Joints.b2DistanceJointDef;f.Initialize(a,d,new Box2D.Common.Math.b2Vec2(250/this.pixelMeterRatio,250/this.pixelMeterRatio),new Box2D.Common.Math.b2Vec2(250/this.pixelMeterRatio,400/this.pixelMeterRatio));this.b2World.CreateJoint(f);f=new Box2D.Dynamics.Joints.b2DistanceJointDef;f.Initialize(a,h,new Box2D.Common.Math.b2Vec2(250/this.pixelMeterRatio,250/this.pixelMeterRatio),new Box2D.Common.Math.b2Vec2(100/this.pixelMeterRatio,250/this.pixelMeterRatio));this.b2World.CreateJoint(f)}, addEducationsToWorld:function(){var a=this.addElementToWorld(600,150,100,"#948C75","Education","","#D5DED9"),c=this.addElementToWorld(650,50,50,"#948C75","UCSD","2008-2011","#D5DED9"),b=this.addElementToWorld(650,350,50,"#948C75","De Anza","2006-2008","#D5DED9"),d=new Box2D.Dynamics.Joints.b2DistanceJointDef;d.Initialize(a,c,new Box2D.Common.Math.b2Vec2(700/this.pixelMeterRatio,250/this.pixelMeterRatio),new Box2D.Common.Math.b2Vec2(700/this.pixelMeterRatio,100/this.pixelMeterRatio));this.b2World.CreateJoint(d); d=new Box2D.Dynamics.Joints.b2DistanceJointDef;d.Initialize(a,b,new Box2D.Common.Math.b2Vec2(700/this.pixelMeterRatio,250/this.pixelMeterRatio),new Box2D.Common.Math.b2Vec2(700/this.pixelMeterRatio,400/this.pixelMeterRatio));this.b2World.CreateJoint(d)},addElementToWorld:function(a,c,b,d,h,f,j){var g=$("<div></div>").attr({width:b*2,height:b*2});g.css("position","absolute");g.css("left",a);g.css("top",c);g.css("-webkit-transform-origin","0% 0%");g.css("-moz-transform-origin","0% 0%");g.css("msTransformOrigin", "0% 0%");$("#b2dDiv").append(g);var i=$("<canvas></canvas>").attr({width:b*2,height:b*2}),e=i[0].getContext("2d");e.fillStyle=this.changeColor(d,0.1,!1);e.beginPath();e.arc(b,b,b,0,Math.PI*2,!0);e.closePath();e.fill();e.fillStyle=d;e.beginPath();e.arc(b,b,b-10,0,Math.PI*2,!0);e.closePath();e.fill();e.fillStyle=j;e.font="18pt Arial";e.textAlign="center";e.fillText(h,b,b);e.font="12pt Arial";e.textAlign="center";e.fillText(f,b,b+20);g.append(i);d=new Box2D.Dynamics.b2BodyDef;d.position.Set(a/this.pixelMeterRatio, c/this.pixelMeterRatio);d.type=Box2D.Dynamics.b2Body.b2_dynamicBody;d.userData=g;a=this.b2World.CreateBody(d);c=new Box2D.Collision.Shapes.b2CircleShape;c.SetRadius(b/this.pixelMeterRatio);c.SetLocalPosition(new Box2D.Common.Math.b2Vec2(b/this.pixelMeterRatio,b/this.pixelMeterRatio));b=new Box2D.Dynamics.b2FixtureDef;b.shape=c;b.density=1;b.friction=0.5;b.restitution=0.2;a.CreateFixture(b);a.SetLinearVelocity(new Box2D.Common.Math.b2Vec2(Math.random()*40-20,Math.random()*20));this.b2Elements.push(a); return a},setDebugDraw:function(){var a=new Box2D.Dynamics.b2DebugDraw;a.SetSprite(document.getElementById("canvas").getContext("2d"));a.SetDrawScale(30);a.SetFillAlpha(0.5);a.SetLineThickness(1);a.SetFlags(Box2D.Dynamics.b2DebugDraw.e_shapeBit|Box2D.Dynamics.b2DebugDraw.e_jointBit);this.b2World.SetDebugDraw(a)},controlMouse:function(){if(this.isMouseDown==!0&&this.b2Joint==null){var a=this.getElementFromWorld();if(a!=null){var c=new Box2D.Dynamics.Joints.b2MouseJointDef;c.bodyA=this.b2World.GetGroundBody(); c.bodyB=a;c.target.Set(this.mouseX,this.mouseY);c.maxForce=3E3*a.GetMass();this.b2Joint=this.b2World.CreateJoint(c)}}if(this.b2Joint!=null)this.isMouseDown==!0?this.b2Joint.SetTarget(new Box2D.Common.Math.b2Vec2(this.mouseX,this.mouseY)):(this.b2World.DestroyJoint(this.b2Joint),this.b2Joint=null)},getElementFromWorld:function(){var a=null;this.b2World.QueryPoint(function(c){return c.GetBody().GetType()==Box2D.Dynamics.b2Body.b2_dynamicBody?(a=c.GetBody(),!1):!0},new Box2D.Common.Math.b2Vec2(this.mouseX, this.mouseY));return a},getElementCoordinates:function(a){for(var c=0,b=0;a&&!isNaN(a.offsetLeft)&&!isNaN(a.offsetTop);)c+=a.offsetLeft-a.scrollLeft,b+=a.offsetTop-a.scrollTop,a=a.offsetParent;return{x:c,y:b}},createBoundaries:function(){var a,c,b,d=$("#b2dDiv");a=new Box2D.Dynamics.b2BodyDef;a.position.Set(d.width()/2/this.pixelMeterRatio,0/this.pixelMeterRatio);a.type=Box2D.Dynamics.b2Body.b2_staticBody;a=this.b2World.CreateBody(a);c=new Box2D.Collision.Shapes.b2PolygonShape;c.SetAsBox(d.width()/ 2/this.pixelMeterRatio,this.boundaryThickness/2/this.pixelMeterRatio);b=new Box2D.Dynamics.b2FixtureDef;b.shape=c;b.friction=0.5;b.restitution=0.5;a.CreateFixture(b);a=new Box2D.Dynamics.b2BodyDef;a.position.Set(d.width()/2/this.pixelMeterRatio,d.height()/this.pixelMeterRatio);a.type=Box2D.Dynamics.b2Body.b2_staticBody;a=this.b2World.CreateBody(a);c=new Box2D.Collision.Shapes.b2PolygonShape;c.SetAsBox(d.width()/2/this.pixelMeterRatio,this.boundaryThickness/2/this.pixelMeterRatio);b=new Box2D.Dynamics.b2FixtureDef; b.shape=c;b.friction=0.5;b.restitution=0.5;a.CreateFixture(b);a=new Box2D.Dynamics.b2BodyDef;a.position.Set(0/this.pixelMeterRatio,d.height()/2/this.pixelMeterRatio);a.type=Box2D.Dynamics.b2Body.b2_staticBody;a=this.b2World.CreateBody(a);c=new Box2D.Collision.Shapes.b2PolygonShape;c.SetAsBox(this.boundaryThickness/2/this.pixelMeterRatio,d.height()/2/this.pixelMeterRatio);b=new Box2D.Dynamics.b2FixtureDef;b.shape=c;b.friction=0.5;b.restitution=0.5;a.CreateFixture(b);a=new Box2D.Dynamics.b2BodyDef; a.position.Set(d.width()/this.pixelMeterRatio,d.height()/2/this.pixelMeterRatio);a.type=Box2D.Dynamics.b2Body.b2_staticBody;a=this.b2World.CreateBody(a);c=new Box2D.Collision.Shapes.b2PolygonShape;c.SetAsBox(this.boundaryThickness/2/this.pixelMeterRatio,d.height()/2/this.pixelMeterRatio);b=new Box2D.Dynamics.b2FixtureDef;b.shape=c;b.friction=0.5;b.restitution=0.5;a.CreateFixture(b)},pad:function(a,c){for(a+="";a.length<c;)a="0"+a;return a},changeColor:function(a,c,b){var a=a.replace(/^\s*|\s*$/,""), a=a.replace(/^#?([a-f0-9])([a-f0-9])([a-f0-9])$/i,"#$1$1$2$2$3$3"),c=Math.round(c*256)*(b?-1:1),d=a.match(RegExp("^rgba?\\(\\s*(\\d|[1-9]\\d|1\\d{2}|2[0-4][0-9]|25[0-5])\\s*,\\s*(\\d|[1-9]\\d|1\\d{2}|2[0-4][0-9]|25[0-5])\\s*,\\s*(\\d|[1-9]\\d|1\\d{2}|2[0-4][0-9]|25[0-5])(?:\\s*,\\s*(0|1|0?\\.\\d+))?\\s*\\)$","i")),h=d&&d[4]!=null?d[4]:null,a=d?[d[1],d[2],d[3]]:a.replace(/^#?([a-f0-9][a-f0-9])([a-f0-9][a-f0-9])([a-f0-9][a-f0-9])/i,function(a,b,c,d){return parseInt(b,16)+","+parseInt(c,16)+","+parseInt(d, 16)}).split(/,/);return d?"rgb"+(h!==null?"a":"")+"("+Math[b?"max":"min"](parseInt(a[0],10)+c,b?0:255)+", "+Math[b?"max":"min"](parseInt(a[1],10)+c,b?0:255)+", "+Math[b?"max":"min"](parseInt(a[2],10)+c,b?0:255)+(h!==null?", "+h:"")+")":["#",this.pad(Math[b?"max":"min"](parseInt(a[0],10)+c,b?0:255).toString(16),2),this.pad(Math[b?"max":"min"](parseInt(a[1],10)+c,b?0:255).toString(16),2),this.pad(Math[b?"max":"min"](parseInt(a[2],10)+c,b?0:255).toString(16),2)].join("")}}))}); $(document).ready(function(){$(".scroll").click(function(a){a.preventDefault();a=this.href.split("#")[1];a=$("#"+a).offset().top;$("html, body").animate({scrollTop:a},1E3)});$("#footer-button").zclip({path:"javascripts/ZeroClipboard.swf",copy:"gladiacxtylish@gmail.com"})});